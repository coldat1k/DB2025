# üé¨ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ 4: –ê–Ω–∞–ª—ñ—Ç–∏—á–Ω—ñ SQL-–∑–∞–ø–∏—Ç–∏ (OLAP)

## 1. –ë–∞–∑–æ–≤–∞ –∞–≥—Ä–µ–≥–∞—Ü—ñ—è (COUNT, SUM, AVG, MIN, MAX)

–¶—ñ –∑–∞–ø–∏—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —à–≤–∏–¥–∫–æ—ó –∑–≤–µ–¥–µ–Ω–æ—ó —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∑ –æ–¥–Ω—ñ—î—ó —Ç–∞–±–ª–∏—Ü—ñ.

| ‚Ññ | –ù–∞–∑–≤–∞ –∑–∞–ø–∏—Ç—É | –©–æ —Ä–æ–±–∏—Ç—å | –ù–∞–≤—ñ—â–æ | –§—É–Ω–∫—Ü—ñ—ó |
| :---: | :--- | :--- | :--- | :--- |
| **1.1** | –ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–ª—ñ—î–Ω—Ç—ñ–≤ | –ü—ñ–¥—Ä–∞—Ö–æ–≤—É—î –∑–∞–≥–∞–ª—å–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Å—ñ–≤ —É —Ç–∞–±–ª–∏—Ü—ñ `CUSTOMER`. | –î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –±–∞–∑–æ–≤–æ—ó –º–µ—Ç—Ä–∏–∫–∏ - —Å–∫—ñ–ª—å–∫–∏ –∫–ª—ñ—î–Ω—Ç—ñ–≤ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ –≤ —Å–∏—Å—Ç–µ–º—ñ. | `COUNT(*)` |
| **1.2** | –ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞ –≤—Å—ñ—Ö –±—Ä–æ–Ω—é–≤–∞–Ω—å | –û–±—á–∏—Å–ª—é—î —Å—É–º—É –≤—Å—ñ—Ö –∑–Ω–∞—á–µ–Ω—å —É —Å—Ç–æ–≤–ø—Ü—ñ `total_amount` —Ç–∞–±–ª–∏—Ü—ñ `BOOKING`. | –î–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ –¥–æ—Ö–æ–¥—É –≤—ñ–¥ —É—Å—ñ—Ö –±—Ä–æ–Ω—é–≤–∞–Ω—å. | `SUM()` |
| **1.3** | –°–µ—Ä–µ–¥–Ω—è —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —Ñ—ñ–ª—å–º—ñ–≤ | –†–æ–∑—Ä–∞—Ö–æ–≤—É—î —Å–µ—Ä–µ–¥–Ω—î –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–Ω–µ —Ç—Ä–∏–≤–∞–ª–æ—Å—Ç—ñ –≤—Å—ñ—Ö —Ñ—ñ–ª—å–º—ñ–≤ (—Å—Ç–æ–≤–ø–µ—Ü—å `duration` —É `MOVIE`). | –î–ª—è –∞–Ω–∞–ª—ñ–∑—É —Å–µ—Ä–µ–¥–Ω—å–æ—ó –¥–æ–≤–∂–∏–Ω–∏ —Ñ—ñ–ª—å–º—ñ–≤ —É –ø—Ä–æ–∫–∞—Ç—ñ. | `AVG()` |
| **1.4** | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ —Ç–∞ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å –∫–≤–∏—Ç–∫–∞ | –ó–Ω–∞—Ö–æ–¥–∏—Ç—å –Ω–∞–π–≤–∏—â—É (`MAX`) —Ç–∞ –Ω–∞–π–Ω–∏–∂—á—É (`MIN`) —Ü—ñ–Ω—É –∫–≤–∏—Ç–∫–∞ —É —Ç–∞–±–ª–∏—Ü—ñ `TICKET`. | –î–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –¥—ñ–∞–ø–∞–∑–æ–Ω—É —Ü—ñ–Ω –Ω–∞ –∫–≤–∏—Ç–∫–∏ –≤ –∫—ñ–Ω–æ—Ç–µ–∞—Ç—Ä—ñ. | `MAX(), MIN()` |
| **1.5** | –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Å–µ–∞–Ω—Å—ñ–≤ –≤—Å—å–æ–≥–æ | –ü—ñ–¥—Ä–∞—Ö–æ–≤—É—î –∑–∞–≥–∞–ª—å–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Å—ñ–≤ —É —Ç–∞–±–ª–∏—Ü—ñ `SHOWING`. | –î–ª—è –∞–Ω–∞–ª—ñ–∑—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ—Å—Ç—ñ –∫—ñ–Ω–æ—Ç–µ–∞—Ç—Ä—É. | `COUNT(*)` |
| **1.6** | –°–µ—Ä–µ–¥–Ω—è —Ü—ñ–Ω–∞ –∫–≤–∏—Ç–∫–∞ | –û–±—á–∏—Å–ª—é—î —Å–µ—Ä–µ–¥–Ω—é —Ü—ñ–Ω—É –≤—Å—ñ—Ö –ø—Ä–æ–¥–∞–Ω–∏—Ö –∫–≤–∏—Ç–∫—ñ–≤ (`TICKET.price`). | –î–ª—è –∞–Ω–∞–ª—ñ–∑—É —Å–µ—Ä–µ–¥–Ω—å–æ—ó –≤–∞—Ä—Ç–æ—Å—Ç—ñ –∫–≤–∏—Ç–∫–∞. | `AVG()` |
| **1.7** | –ú—ñ–Ω/–º–∞–∫—Å –∫—ñ–ª—å–∫—ñ—Å—Ç—å –º—ñ—Å—Ü—å —É –∑–∞–ª–∞—Ö | –ó–Ω–∞—Ö–æ–¥–∏—Ç—å –∑–∞–ª –∑ –Ω–∞–π–º–µ–Ω—à–æ—é —Ç–∞ –Ω–∞–π–±—ñ–ª—å—à–æ—é –º—ñ—Å—Ç–∫—ñ—Å—Ç—é, –æ–±—á–∏—Å–ª—é—é—á–∏ min/max –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –º—ñ—Å—Ü—å (`SEAT`) –ø–æ –∑–∞–ª–∞—Ö. | –î–ª—è –ø–ª–∞–Ω—É–≤–∞–Ω–Ω—è —Ä–æ–∑–ø–æ–¥—ñ–ª—É —Ñ—ñ–ª—å–º—ñ–≤ –ø–æ –∑–∞–ª–∞—Ö. | `MIN(), MAX()` |

---

## 2. –ì—Ä—É–ø—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö (GROUP BY)

–¶—ñ –∑–∞–ø–∏—Ç–∏ –∞–≥—Ä–µ–≥—É—é—Ç—å –¥–∞–Ω—ñ, –≥—Ä—É–ø—É—é—á–∏ —ó—Ö –∑–∞ –ø–µ–≤–Ω–∏–º –∫—Ä–∏—Ç–µ—Ä—ñ—î–º (—Å—Ç–æ–≤–ø—Ü–µ–º).

| ‚Ññ | –ù–∞–∑–≤–∞ –∑–∞–ø–∏—Ç—É | –©–æ —Ä–æ–±–∏—Ç—å | –ù–∞–≤—ñ—â–æ | –ì—Ä—É–ø—É–≤–∞–Ω–Ω—è |
| :---: | :--- | :--- | :--- | :--- |
| **2.1** | –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Å–µ–∞–Ω—Å—ñ–≤ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ñ—ñ–ª—å–º—É | –ì—Ä—É–ø—É—î —Å–µ–∞–Ω—Å–∏ (`SHOWING`) –∑–∞ —Ñ—ñ–ª—å–º–∞–º–∏ (`MOVIE`) —Ç–∞ –ø—ñ–¥—Ä–∞—Ö–æ–≤—É—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–µ–∞–Ω—Å—ñ–≤ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ. | –î–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—ñ —Ñ—ñ–ª—å–º—ñ–≤ (—è–∫—ñ —Ñ—ñ–ª—å–º–∏ —á–∞—Å—Ç—ñ—à–µ –ø–æ–∫–∞–∑—É—é—Ç—å). | `GROUP BY m.title` |
| **2.2** | –ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞ –±—Ä–æ–Ω—é–≤–∞–Ω—å –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞ | –ì—Ä—É–ø—É—î –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è (`BOOKING`) –∑–∞ –∫–ª—ñ—î–Ω—Ç–∞–º–∏ (`CUSTOMER`) —Ç–∞ –ø—ñ–¥—Å—É–º–æ–≤—É—î —ó—Ö –≤–∏—Ç—Ä–∞—Ç–∏ (`total_amount`). | –î–ª—è –∞–Ω–∞–ª—ñ–∑—É –ª–æ—è–ª—å–Ω–æ—Å—Ç—ñ –∫–ª—ñ—î–Ω—Ç—ñ–≤ —Ç–∞ —ó—Ö –≤–∏—Ç—Ä–∞—Ç. | `GROUP BY c.full_name` |
| **2.3** | –ö—ñ–ª—å–∫—ñ—Å—Ç—å –º—ñ—Å—Ü—å —É –∫–æ–∂–Ω–æ–º—É –∑–∞–ª—ñ | –û–±'—î–¥–Ω—É—î `HALL` —Ç–∞ `SEAT` —ñ –ø—ñ–¥—Ä–∞—Ö–æ–≤—É—î –º—ñ—Å—Ç–∫—ñ—Å—Ç—å (`COUNT(seat_id)`) –∫–æ–∂–Ω–æ–≥–æ –∑–∞–ª—É (`name_hall`). | –î–ª—è –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –º—ñ—Å—Ç–∫–æ—Å—Ç—ñ —Ä—ñ–∑–Ω–∏—Ö –∑–∞–ª—ñ–≤. | `GROUP BY h.name_hall` |
| **2.4** | –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∫–≤–∏—Ç–∫—ñ–≤, –ø—Ä–æ–¥–∞–Ω–∏—Ö –Ω–∞ –∫–æ–∂–µ–Ω —Ñ—ñ–ª—å–º | –û–±'—î–¥–Ω—É—î `MOVIE`, `SHOWING` —Ç–∞ `TICKET`, –≥—Ä—É–ø—É—é—á–∏ –ø—Ä–æ–¥–∞–Ω—ñ –∫–≤–∏—Ç–∫–∏ –∑–∞ –Ω–∞–∑–≤–∞–º–∏ —Ñ—ñ–ª—å–º—ñ–≤. | –î–ª—è –∞–Ω–∞–ª—ñ–∑—É –∫–∞—Å–æ–≤–∏—Ö –∑–±–æ—Ä—ñ–≤ –ø–æ —Ñ—ñ–ª—å–º–∞—Ö. | `GROUP BY m.title` |
| **2.5** | –ö—ñ–ª—å–∫—ñ—Å—Ç—å –±—Ä–æ–Ω—é–≤–∞–Ω—å –ø–æ –¥–Ω—è—Ö | –ì—Ä—É–ø—É—î –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è –∑–∞ –¥–∞—Ç–∞–º–∏ —ó—Ö —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è (`booking_date`). | –î–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –¥–Ω—ñ–≤ –∑ –Ω–∞–π–≤–∏—â–æ—é –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é –±—Ä–æ–Ω—é–≤–∞–Ω—å. | `GROUP BY booking_date` |

---

## 3. –§—ñ–ª—å—Ç—Ä—É–≤–∞–Ω–Ω—è –≥—Ä—É–ø (HAVING)

–¶—ñ –∑–∞–ø–∏—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä—É—é—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏, –æ—Ç—Ä–∏–º–∞–Ω—ñ –ø—ñ—Å–ª—è –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó (`GROUP BY`), –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `HAVING`.

| ‚Ññ | –ù–∞–∑–≤–∞ –∑–∞–ø–∏—Ç—É | –©–æ —Ä–æ–±–∏—Ç—å | –ù–∞–≤—ñ—â–æ | –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –≥—Ä—É–ø |
| :---: | :--- | :--- | :--- | :--- |
| **3.1** | –ö–ª—ñ—î–Ω—Ç–∏, —è–∫—ñ –≤–∏—Ç—Ä–∞—Ç–∏–ª–∏ –±—ñ–ª—å—à–µ 200 –≥—Ä–Ω | –í–∏–±–∏—Ä–∞—î –∫–ª—ñ—î–Ω—Ç—ñ–≤, —Å—É–º–∞—Ä–Ω—ñ –≤–∏—Ç—Ä–∞—Ç–∏ (`SUM(b.total_amount)`) —è–∫–∏—Ö –ø–µ—Ä–µ–≤–∏—â—É—é—Ç—å 200 –≥—Ä–Ω. | –î–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞–π–±—ñ–ª—å—à —Ü—ñ–Ω–Ω–∏—Ö –∫–ª—ñ—î–Ω—Ç—ñ–≤ (VIP). | `HAVING SUM(b.total_amount) > 200` |
| **3.2** | –ñ–∞–Ω—Ä–∏ –∑ —Å–µ—Ä–µ–¥–Ω—å–æ—é —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—é > 140 —Ö–≤ | –í–∏–±–∏—Ä–∞—î –∂–∞–Ω—Ä–∏, —Å–µ—Ä–µ–¥–Ω—è —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —Ñ—ñ–ª—å–º—ñ–≤ —è–∫–∏—Ö (`AVG(m.duration)`) –±—ñ–ª—å—à–µ 140 —Ö–≤–∏–ª–∏–Ω. | –î–ª—è –∞–Ω–∞–ª—ñ–∑—É —Ç—Ä–∏–≤–∞–ª–æ—Å—Ç—ñ —Ñ—ñ–ª—å–º—ñ–≤ –∑–∞ –∂–∞–Ω—Ä–∞–º–∏. | `HAVING AVG(m.duration) > 140` |
| **3.3** | –ó–∞–ª–∏ –∑ –±—ñ–ª—å—à–µ –Ω—ñ–∂ 1 —Å–µ–∞–Ω—Å–æ–º | –ó–Ω–∞—Ö–æ–¥–∏—Ç—å –∑–∞–ª–∏, –≤ —è–∫–∏—Ö –∑–∞–ø–ª–∞–Ω–æ–≤–∞–Ω–æ –±—ñ–ª—å—à–µ –æ–¥–Ω–æ–≥–æ —Å–µ–∞–Ω—Å—É (`COUNT(s.session_id)`). | –î–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –Ω–∞–π–±—ñ–ª—å—à –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏—Ö –∑–∞–ª—ñ–≤. | `HAVING COUNT(s.session_id) > 1` |
| **3.4** | –§—ñ–ª—å–º–∏ –∑ –±—ñ–ª—å—à–µ –Ω—ñ–∂ 1 –ø—Ä–æ–¥–∞–Ω–∏–º –∫–≤–∏—Ç–∫–æ–º | –í–∏–±–∏—Ä–∞—î —Ñ—ñ–ª—å–º–∏, –Ω–∞ —è–∫—ñ –ø—Ä–æ–¥–∞–Ω–æ –±—ñ–ª—å—à–µ –æ–¥–Ω–æ–≥–æ –∫–≤–∏—Ç–∫–∞ (`COUNT(t.ticket_id)`). | –î–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ–ø—É–ª—è—Ä–Ω–∏—Ö —Ñ—ñ–ª—å–º—ñ–≤. | `HAVING COUNT(t.ticket_id) > 1` |
| **3.5** | –î–Ω—ñ –∑ –±—ñ–ª—å—à–µ –Ω—ñ–∂ 1 –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è–º | –ó–Ω–∞—Ö–æ–¥–∏—Ç—å –¥–Ω—ñ, –∫–æ–ª–∏ –±—É–ª–æ –∑—Ä–æ–±–ª–µ–Ω–æ –±—ñ–ª—å—à–µ –æ–¥–Ω–æ–≥–æ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è (`COUNT(*)`). | –î–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –ø—ñ–∫–æ–≤–∏—Ö –¥–Ω—ñ–≤ –ø—Ä–æ–¥–∞–∂—ñ–≤. | `HAVING COUNT(*) > 1` |

---

## 4. –û–ø–µ—Ä–∞—Ü—ñ—ó JOIN (–û–±'—î–¥–Ω–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö)

–¶—ñ –∑–∞–ø–∏—Ç–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—é—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤ –æ–ø–µ—Ä–∞—Ü—ñ–π –æ–±'—î–¥–Ω–∞–Ω–Ω—è.

| ‚Ññ | –ù–∞–∑–≤–∞ –∑–∞–ø–∏—Ç—É | –©–æ —Ä–æ–±–∏—Ç—å | –ù–∞–≤—ñ—â–æ | –¢–∏–ø JOIN |
| :---: | :--- | :--- | :--- | :--- |
| **4.1** | –î–µ—Ç–∞–ª—å–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–≤–∏—Ç–∫–∏ | –û–±'—î–¥–Ω—É—î 6 —Ç–∞–±–ª–∏—Ü—å (`TICKET`, `BOOKING`, `CUSTOMER`, `SHOWING`, `MOVIE`, `SEAT`) –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø–æ–≤–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –∫–æ–∂–µ–Ω –∫–≤–∏—Ç–æ–∫. | –î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∑–≤—ñ—Ç—É –ø–æ –≤—Å—ñ—Ö –ø—Ä–æ–¥–∞–Ω–∏—Ö –∫–≤–∏—Ç–∫–∞—Ö. | –ú–Ω–æ–∂–∏–Ω–Ω–∏–π `INNER JOIN` |
| **4.2** | –í—Å—ñ –∑–∞–ª–∏ —Ç–∞ —ó—Ö —Å–µ–∞–Ω—Å–∏ | –ü–æ–∫–∞–∑—É—î –≤—Å—ñ –∑–∞–ª–∏ (`HALL`), –Ω–∞–≤—ñ—Ç—å —Ç—ñ, –≤ —è–∫–∏—Ö —â–µ –Ω–µ –±—É–ª–æ —Å–µ–∞–Ω—Å—ñ–≤ (`SHOWING`). | –î–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É –≤—Å—ñ—Ö –∑–∞–ª—ñ–≤ –Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —ó—Ö –∑–∞–π–Ω—è—Ç–æ—Å—Ç—ñ. | `LEFT JOIN` |
| **4.3** | –í—Å—ñ —Å–µ–∞–Ω—Å–∏ —Ç–∞ –∑–∞–ª–∏ | –ü–æ–∫–∞–∑—É—î –≤—Å—ñ —Å–µ–∞–Ω—Å–∏ (`SHOWING`) –∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ –∑–∞–ª–∏ (`HALL`), –≤–∫–ª—é—á–∞—é—á–∏ –ª–∏—à–µ —Ç—ñ, —â–æ –º–∞—é—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ –¥–∞–Ω—ñ. | –î–ª—è –∞–Ω–∞–ª—ñ–∑—É —Ä–æ–∑–∫–ª–∞–¥—É —Å–µ–∞–Ω—Å—ñ–≤. | `RIGHT JOIN` |
| **4.4** | –í—Å—ñ –∫–ª—ñ—î–Ω—Ç–∏ —Ç–∞ –≤—Å—ñ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è | –û–±'—î–¥–Ω—É—î `CUSTOMER` —Ç–∞ `BOOKING`. –ü–æ–∫–∞–∑—É—î –≤—Å—ñ—Ö –∫–ª—ñ—î–Ω—Ç—ñ–≤ —ñ –≤—Å—ñ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è, –≤–∫–ª—é—á–∞—é—á–∏ –Ω–µ–∑–∞–ø–æ–≤–Ω–µ–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ (–∫–ª—ñ—î–Ω—Ç–∏ –±–µ–∑ –±—Ä–æ–Ω—é–≤–∞–Ω—å –∞–±–æ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è –±–µ–∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞). | –î–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –∫–ª—ñ—î–Ω—Ç—ñ–≤ –±–µ–∑ –±—Ä–æ–Ω—é–≤–∞–Ω—å —Ç–∞ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏—Ö –±—Ä–æ–Ω—é–≤–∞–Ω—å. | `FULL JOIN` |
| **4.5** | –í—Å—ñ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó —Ñ—ñ–ª—å–º—ñ–≤ —Ç–∞ –∑–∞–ª—ñ–≤ | –°—Ç–≤–æ—Ä—é—î –¥–µ–∫–∞—Ä—Ç–æ–≤–∏–π –¥–æ–±—É—Ç–æ–∫ —Ñ—ñ–ª—å–º—ñ–≤ (`MOVIE`) —Ç–∞ –∑–∞–ª—ñ–≤ (`HALL`). | –î–ª—è –ø–ª–∞–Ω—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –º–æ–∂–ª–∏–≤–∏—Ö –∫–æ–º–±—ñ–Ω–∞—Ü—ñ–π –¥–ª—è —Ä–æ–∑–∫–ª–∞–¥—É —Å–µ–∞–Ω—Å—ñ–≤. | `CROSS JOIN` |

---

## 5. –ó–∞–ø–∏—Ç–∏ –∑ –ø—ñ–¥–∑–∞–ø–∏—Ç–∞–º–∏ (Subqueries)

–¶—ñ –∑–∞–ø–∏—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–¥–Ω–æ–≥–æ `SELECT` –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —ñ–Ω—à–æ–≥–æ –∑–∞–ø–∏—Ç—É (`SELECT`, `WHERE`, `HAVING`, `FROM`).

| ‚Ññ | –ù–∞–∑–≤–∞ –∑–∞–ø–∏—Ç—É | –©–æ —Ä–æ–±–∏—Ç—å | –ù–∞–≤—ñ—â–æ | –†–æ–∑–º—ñ—â–µ–Ω–Ω—è –ø—ñ–¥–∑–∞–ø–∏—Ç—É |
| :---: | :--- | :--- | :--- | :--- |
| **5.1** | –ö—ñ–ª—å–∫—ñ—Å—Ç—å –±—Ä–æ–Ω—é–≤–∞–Ω—å –∫–ª—ñ—î–Ω—Ç–∞ | –î–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞ (`CUSTOMER`) –¥–æ–¥–∞—î —Å—Ç–æ–≤–ø–µ—Ü—å –∑ –∫—ñ–ª—å–∫—ñ—Å—Ç—é –π–æ–≥–æ –±—Ä–æ–Ω—é–≤–∞–Ω—å (`BOOKING`). | –î–ª—è –∞–Ω–∞–ª—ñ–∑—É –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –∫–ª—ñ—î–Ω—Ç—ñ–≤ –±–µ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `GROUP BY`. | –£ –≤–∏–±—ñ—Ä–∫–æ–≤–æ–º—É —Å–ø–∏—Å–∫—É `SELECT` |
| **5.2** | –ö–≤–∏—Ç–∫–∏ –¥–æ—Ä–æ–∂—á—ñ –∑–∞ —Å–µ—Ä–µ–¥–Ω—é —Ü—ñ–Ω—É | –í–∏–±–∏—Ä–∞—î –∫–≤–∏—Ç–∫–∏, —Ü—ñ–Ω–∞ —è–∫–∏—Ö –≤–∏—â–∞ –∑–∞ —Å–µ—Ä–µ–¥–Ω—é —Ü—ñ–Ω—É –≤—Å—ñ—Ö –∫–≤–∏—Ç–∫—ñ–≤, —è–∫—É –æ–±—á–∏—Å–ª—é—î –ø—ñ–¥–∑–∞–ø–∏—Ç. | –î–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è "–ø—Ä–µ–º—ñ–∞–ª—å–Ω–∏—Ö" –∫–≤–∏—Ç–∫—ñ–≤. | –£ —É–º–æ–≤—ñ `WHERE` |
| **5.3** | –ñ–∞–Ω—Ä–∏ –∑ —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—é –≤–∏—â–µ —Å–µ—Ä–µ–¥–Ω—å–æ—ó | –í–∏–±–∏—Ä–∞—î –∂–∞–Ω—Ä–∏, –¥–µ —Å–µ—Ä–µ–¥–Ω—è —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —Ñ—ñ–ª—å–º—ñ–≤ –ø–µ—Ä–µ–≤–∏—â—É—î –∑–∞–≥–∞–ª—å–Ω—É —Å–µ—Ä–µ–¥–Ω—é —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —É—Å—ñ—Ö —Ñ—ñ–ª—å–º—ñ–≤, —è–∫—É –æ–±—á–∏—Å–ª—é—î –ø—ñ–¥–∑–∞–ø–∏—Ç. | –î–ª—è –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∂–∞–Ω—Ä—ñ–≤ —ñ–∑ —Å–µ—Ä–µ–¥–Ω—ñ–º–∏ –ø–æ–∫–∞–∑–Ω–∏–∫–∞–º–∏. | –£ —É–º–æ–≤—ñ `HAVING` |
| **5.4** | –ù–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à—ñ —Ñ—ñ–ª—å–º–∏ (–∑–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—é –∫–≤–∏—Ç–∫—ñ–≤) | –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø—ñ–¥–∑–∞–ø–∏—Ç —è–∫ —Ç–∏–º—á–∞—Å–æ–≤—É —Ç–∞–±–ª–∏—Ü—é (`FROM`), —â–æ–± —Å–ø–æ—á–∞—Ç–∫—É –ø—ñ–¥—Ä–∞—Ö—É–≤–∞—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–≤–∏—Ç–∫—ñ–≤ –Ω–∞ –∫–æ–∂–µ–Ω —Ñ—ñ–ª—å–º, –∞ –ø–æ—Ç—ñ–º –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –∞–±–æ —Ä–∞–Ω–∂—É–≤–∞—Ç–∏ —Ü—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏. | –î–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Å–∫–ª–∞–¥–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å —É –∫—ñ–ª—å–∫–∞ –µ—Ç–∞–ø—ñ–≤. | –£ —Ä–µ—á–µ–Ω–Ω—ñ `FROM` |
| **5.5** | –ö–ª—ñ—î–Ω—Ç–∏ –∑ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è–º–∏ | –í–∏–±–∏—Ä–∞—î –∫–ª—ñ—î–Ω—Ç—ñ–≤ (`CUSTOMER`), —á–∏—ó `customer_id` —î –≤ —Ç–∞–±–ª–∏—Ü—ñ `BOOKING`. | –î–ª—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –∞–∫—Ç–∏–≤–Ω–∏—Ö –∫–ª—ñ—î–Ω—Ç—ñ–≤. | –ó –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º `IN` |

---

## 6. –ë–∞–≥–∞—Ç–æ—Ç–∞–±–ª–∏—á–Ω–∞ –∞–≥—Ä–µ–≥–∞—Ü—ñ—è

–¶—ñ –∑–∞–ø–∏—Ç–∏ –æ–±'—î–¥–Ω—É—é—Ç—å –∫—ñ–ª—å–∫–∞ —Ç–∞–±–ª–∏—Ü—å –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Å–∫–ª–∞–¥–Ω–∏—Ö –∑–≤–µ–¥–µ–Ω–∏—Ö –∑–≤—ñ—Ç—ñ–≤.

| ‚Ññ | –ù–∞–∑–≤–∞ –∑–∞–ø–∏—Ç—É | –©–æ —Ä–æ–±–∏—Ç—å | –ù–∞–≤—ñ—â–æ | –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å |
| :---: | :--- | :--- | :--- | :--- |
| **6.1** | –ó–∞–≥–∞–ª—å–Ω–∏–π –¥–æ—Ö—ñ–¥ –≤—ñ–¥ –∫–æ–∂–Ω–æ–≥–æ —Ñ—ñ–ª—å–º—É | –û–±'—î–¥–Ω—É—î `MOVIE`, `SHOWING` —Ç–∞ `TICKET` —ñ –∞–≥—Ä–µ–≥—É—î —Å—É–º—É —Ü—ñ–Ω –∫–≤–∏—Ç–∫—ñ–≤ (`SUM(price)`) –ø–æ –Ω–∞–∑–≤–∞—Ö —Ñ—ñ–ª—å–º—ñ–≤. | –î–ª—è –∞–Ω–∞–ª—ñ–∑—É –∫–∞—Å–æ–≤–∏—Ö –∑–±–æ—Ä—ñ–≤ –ø–æ –∫–æ–∂–Ω–æ–º—É —Ñ—ñ–ª—å–º—É. | 2 `JOIN` + `GROUP BY` |
| **6.2** | –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–¥–∞–Ω–∏—Ö –∫–≤–∏—Ç–∫—ñ–≤ –Ω–∞ –∫–æ–∂–µ–Ω —Å–µ–∞–Ω—Å | –û–±'—î–¥–Ω—É—î `TICKET`, `SHOWING` —Ç–∞ `MOVIE` —ñ –ø—ñ–¥—Ä–∞—Ö–æ–≤—É—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–≤–∏—Ç–∫—ñ–≤ (`COUNT(ticket_id)`) –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Å–µ–∞–Ω—Å—É. | –î–ª—è –∞–Ω–∞–ª—ñ–∑—É –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–æ—Å—Ç—ñ –æ–∫—Ä–µ–º–∏—Ö —Å–µ–∞–Ω—Å—ñ–≤. | 2 `JOIN` + `GROUP BY` |
| **6.3** | –ó–∞–≥–∞–ª—å–Ω–∞ –≤–∏—Ä—É—á–∫–∞ –ø–æ –∑–∞–ª–∞—Ö | –û–±'—î–¥–Ω—É—î `HALL`, `SHOWING` —Ç–∞ `TICKET` —Ç–∞ –∞–≥—Ä–µ–≥—É—î –≤–∏—Ä—É—á–∫—É (`SUM(price)`) –ø–æ –∫–æ–∂–Ω–æ–º—É –∑–∞–ª—É. | –î–ª—è –æ—Ü—ñ–Ω–∫–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑–∞–ª—ñ–≤. | 2 `JOIN` + `GROUP BY` |
| **6.4** | –î–æ—Ö–æ–¥ –ø–æ –¥–Ω—è—Ö –∑ –¥–µ—Ç–∞–ª—ñ–∑–∞—Ü—ñ—î—é | –ì—Ä—É–ø—É—î –¥–æ—Ö—ñ–¥ –∑–∞ –¥–∞—Ç–∞–º–∏ (`start_time`) —Ç–∞ –Ω–∞–∑–≤–∞–º–∏ —Ñ—ñ–ª—å–º—ñ–≤ (`title`). | –î–ª—è –¥–µ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É –ø—Ä–æ–¥–∞–∂—ñ–≤ –∑ –¥–µ—Ç–∞–ª—ñ–∑–∞—Ü—ñ—î—é. | 3 `JOIN` + `GROUP BY` –∑–∞ –¥–≤–æ–º–∞ –ø–æ–ª—è–º–∏ |
| **6.5** | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–ª—ñ—î–Ω—Ç–∞—Ö –∑ –¥–µ—Ç–∞–ª—ñ–∑–∞—Ü—ñ—î—é | –ù–∞–¥–∞—î –∫–æ–º–ø–ª–µ–∫—Å–Ω—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∫–æ–∂–Ω–æ–º—É –∫–ª—ñ—î–Ω—Ç—É, –≤–∫–ª—é—á–∞—é—á–∏ –∑–∞–≥–∞–ª—å–Ω—ñ –≤–∏—Ç—Ä–∞—Ç–∏ —Ç–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–≤–∏—Ç–∫—ñ–≤/–±—Ä–æ–Ω—é–≤–∞–Ω—å (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ `LEFT JOIN` –¥–ª—è –≤–∫–ª—é—á–µ–Ω–Ω—è –Ω–µ–∞–∫—Ç–∏–≤–Ω–∏—Ö –∫–ª—ñ—î–Ω—Ç—ñ–≤). | –î–ª—è –≤—Å–µ–±—ñ—á–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É –∫–ª—ñ—î–Ω—Ç—Å—å–∫–æ—ó –±–∞–∑–∏. | 2 `LEFT JOIN` + `GROUP BY` |
