generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model booking {
  booking_id   Int      @id @default(autoincrement())
  customer_id  Int
  total_amount Decimal  @db.Decimal(8, 2)
  customer     customer @relation(fields: [customer_id], references: [customer_id], onDelete: NoAction, onUpdate: NoAction)
  ticket       ticket[]
}

model customer {
  customer_id   Int       @id @default(autoincrement())
  full_name     String    @db.VarChar(100)
  email_address String    @unique @db.VarChar(100)
  phone_number  String    @db.VarChar(15)
  booking       booking[]
}

model genre {
  genre_id    Int           @id @default(autoincrement())
  genre_n  String           @unique @db.VarChar(40)
  movie_genre movie_genre[]
}
  
model hall {
  hall_id   Int       @id @default(autoincrement())
  name_hall String    @unique @db.VarChar(10)
  type_hall String    @db.VarChar(15)
  seat      seat[]
  showing   showing[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model movie {
  movie_id     Int           @id @default(autoincrement())
  title        String        @db.VarChar(40)
  release_date DateTime      @db.Date
  duration     Int
  movie_genre  movie_genre[]
  showing      showing[]
}

model movie_genre {
  movie_id Int
  genre_id Int
  genre    genre @relation(fields: [genre_id], references: [genre_id], onDelete: Cascade, onUpdate: NoAction)
  movie    movie @relation(fields: [movie_id], references: [movie_id], onDelete: Cascade, onUpdate: NoAction)

  @@id([movie_id, genre_id])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model seat {
  seat_id     Int      @id @default(autoincrement())
  hall_id     Int
  row_num     Int
  seat_number Int
  hall        hall     @relation(fields: [hall_id], references: [hall_id], onDelete: NoAction, onUpdate: NoAction)
  ticket      ticket[]

  @@unique([hall_id, row_num, seat_number], map: "uq_seatlocation")
}

model showing {
  session_id Int      @id @default(autoincrement())
  movie_id   Int
  hall_id    Int
  start_time DateTime @db.Timestamptz(6)
  hall       hall     @relation(fields: [hall_id], references: [hall_id], onDelete: NoAction, onUpdate: NoAction)
  movie      movie    @relation(fields: [movie_id], references: [movie_id], onDelete: NoAction, onUpdate: NoAction)
  ticket     ticket[]

  @@unique([hall_id, start_time], map: "uq_halltime")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model ticket {
  ticket_id  Int     @id @default(autoincrement())
  booking_id Int
  session_id Int
  seat_id    Int
  price      Decimal @db.Decimal(6, 2)
  booking    booking @relation(fields: [booking_id], references: [booking_id], onDelete: NoAction, onUpdate: NoAction)
  seat       seat    @relation(fields: [seat_id], references: [seat_id], onDelete: NoAction, onUpdate: NoAction)
  showing    showing @relation(fields: [session_id], references: [session_id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([session_id, seat_id], map: "uq_ticket")
}

model services {
  services_id Int @id @default(autoincrement())
  popcorn Boolean
  Pepsi Boolean
}


